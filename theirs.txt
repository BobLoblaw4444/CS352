(Program (Main (PrintStatement (CallExp (new "TV") "Start"))) (ClassDecl "TV" null (MethodDecl (TypeInt) "Start" (Parameters) (VarDecls (VarDecl (Type "Tree") "root") (VarDecl (TypeBoolean) "ntb") (VarDecl (TypeInt) "nti") (VarDecl (Type "MyVisitor") "v")) (Statements (ExpStatement (AssignExp (VarExp "root") (new "Tree"))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Init" (int 16)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Print"))) (PrintStatement (int 100000000)) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Insert" (int 8)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Insert" (int 24)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Insert" (int 4)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Insert" (int 12)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Insert" (int 20)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Insert" (int 28)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Insert" (int 14)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Print"))) (PrintStatement (int 100000000)) (ExpStatement (AssignExp (VarExp "v") (new "MyVisitor"))) (PrintStatement (int 50000000)) (ExpStatement (AssignExp (VarExp "nti") (CallExp (VarExp "root") "accept" (VarExp "v")))) (PrintStatement (int 100000000)) (PrintStatement (CallExp (VarExp "root") "Search" (int 24))) (PrintStatement (CallExp (VarExp "root") "Search" (int 12))) (PrintStatement (CallExp (VarExp "root") "Search" (int 16))) (PrintStatement (CallExp (VarExp "root") "Search" (int 50))) (PrintStatement (CallExp (VarExp "root") "Search" (int 12))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Delete" (int 12)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "root") "Print"))) (PrintStatement (CallExp (VarExp "root") "Search" (int 12)))) (Return (int 0)))) (ClassDecl "Tree" null (VarDecl (Type "Tree") "left") (VarDecl (Type "Tree") "right") (VarDecl (TypeInt) "key") (VarDecl (TypeBoolean) "has_left") (VarDecl (TypeBoolean) "has_right") (VarDecl (Type "Tree") "my_null") (MethodDecl (TypeBoolean) "Init" (Parameters (Parameter (TypeInt) "v_key")) (VarDecls) (Statements (ExpStatement (AssignExp (VarExp "key") (VarExp "v_key"))) (ExpStatement (AssignExp (VarExp "has_left") (boolean false))) (ExpStatement (AssignExp (VarExp "has_right") (boolean false)))) (Return (boolean true))) (MethodDecl (TypeBoolean) "SetRight" (Parameters (Parameter (Type "Tree") "rn")) (VarDecls) (Statements (ExpStatement (AssignExp (VarExp "right") (VarExp "rn")))) (Return (boolean true))) (MethodDecl (TypeBoolean) "SetLeft" (Parameters (Parameter (Type "Tree") "ln")) (VarDecls) (Statements (ExpStatement (AssignExp (VarExp "left") (VarExp "ln")))) (Return (boolean true))) (MethodDecl (Type "Tree") "GetRight" (Parameters) (VarDecls) (Statements) (Return (VarExp "right"))) (MethodDecl (Type "Tree") "GetLeft" (Parameters) (VarDecls) (Statements) (Return (VarExp "left"))) (MethodDecl (TypeInt) "GetKey" (Parameters) (VarDecls) (Statements) (Return (VarExp "key"))) (MethodDecl (TypeBoolean) "SetKey" (Parameters (Parameter (TypeInt) "v_key")) (VarDecls) (Statements (ExpStatement (AssignExp (VarExp "key") (VarExp "v_key")))) (Return (boolean true))) (MethodDecl (TypeBoolean) "GetHas_Right" (Parameters) (VarDecls) (Statements) (Return (VarExp "has_right"))) (MethodDecl (TypeBoolean) "GetHas_Left" (Parameters) (VarDecls) (Statements) (Return (VarExp "has_left"))) (MethodDecl (TypeBoolean) "SetHas_Left" (Parameters (Parameter (TypeBoolean) "val")) (VarDecls) (Statements (ExpStatement (AssignExp (VarExp "has_left") (VarExp "val")))) (Return (boolean true))) (MethodDecl (TypeBoolean) "SetHas_Right" (Parameters (Parameter (TypeBoolean) "val")) (VarDecls) (Statements (ExpStatement (AssignExp (VarExp "has_right") (VarExp "val")))) (Return (boolean true))) (MethodDecl (TypeBoolean) "Compare" (Parameters (Parameter (TypeInt) "num1") (Parameter (TypeInt) "num2")) (VarDecls (VarDecl (TypeBoolean) "ntb") (VarDecl (TypeInt) "nti")) (Statements (ExpStatement (AssignExp (VarExp "ntb") (boolean false))) (ExpStatement (AssignExp (VarExp "nti") (+ (VarExp "num2") (int 1)))) (IfStatement (< (VarExp "num1") (VarExp "num2")) (ExpStatement (AssignExp (VarExp "ntb") (boolean false))) (IfStatement (NotExp (< (VarExp "num1") (VarExp "nti"))) (ExpStatement (AssignExp (VarExp "ntb") (boolean false))) (ExpStatement (AssignExp (VarExp "ntb") (boolean true)))))) (Return (VarExp "ntb"))) (MethodDecl (TypeBoolean) "Insert" (Parameters (Parameter (TypeInt) "v_key")) (VarDecls (VarDecl (Type "Tree") "new_node") (VarDecl (TypeBoolean) "ntb") (VarDecl (Type "Tree") "current_node") (VarDecl (TypeBoolean) "cont") (VarDecl (TypeInt) "key_aux")) (Statements (ExpStatement (AssignExp (VarExp "new_node") (new "Tree"))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "new_node") "Init" (VarExp "v_key")))) (ExpStatement (AssignExp (VarExp "current_node") (ThisExp))) (ExpStatement (AssignExp (VarExp "cont") (boolean true))) (WhileStatement (VarExp "cont") (BlockStatement (ExpStatement (AssignExp (VarExp "key_aux") (CallExp (VarExp "current_node") "GetKey"))) (IfStatement (< (VarExp "v_key") (VarExp "key_aux")) (BlockStatement (IfStatement (CallExp (VarExp "current_node") "GetHas_Left") (ExpStatement (AssignExp (VarExp "current_node") (CallExp (VarExp "current_node") "GetLeft"))) (BlockStatement (ExpStatement (AssignExp (VarExp "cont") (boolean false))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "current_node") "SetHas_Left" (boolean true)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "current_node") "SetLeft" (VarExp "new_node"))))))) (BlockStatement (IfStatement (CallExp (VarExp "current_node") "GetHas_Right") (ExpStatement (AssignExp (VarExp "current_node") (CallExp (VarExp "current_node") "GetRight"))) (BlockStatement (ExpStatement (AssignExp (VarExp "cont") (boolean false))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "current_node") "SetHas_Right" (boolean true)))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "current_node") "SetRight" (VarExp "new_node"))))))))))) (Return (boolean true))) (MethodDecl (TypeBoolean) "Delete" (Parameters (Parameter (TypeInt) "v_key")) (VarDecls (VarDecl (Type "Tree") "current_node") (VarDecl (Type "Tree") "parent_node") (VarDecl (TypeBoolean) "cont") (VarDecl (TypeBoolean) "found") (VarDecl (TypeBoolean) "ntb") (VarDecl (TypeBoolean) "is_root") (VarDecl (TypeInt) "key_aux")) (Statements (ExpStatement (AssignExp (VarExp "current_node") (ThisExp))) (ExpStatement (AssignExp (VarExp "parent_node") (ThisExp))) (ExpStatement (AssignExp (VarExp "cont") (boolean true))) (ExpStatement (AssignExp (VarExp "found") (boolean false))) (ExpStatement (AssignExp (VarExp "is_root") (boolean true))) (WhileStatement (VarExp "cont") (BlockStatement (ExpStatement (AssignExp (VarExp "key_aux") (CallExp (VarExp "current_node") "GetKey"))) (IfStatement (< (VarExp "v_key") (VarExp "key_aux")) (IfStatement (CallExp (VarExp "current_node") "GetHas_Left") (BlockStatement (ExpStatement (AssignExp (VarExp "parent_node") (VarExp "current_node"))) (ExpStatement (AssignExp (VarExp "current_node") (CallExp (VarExp "current_node") "GetLeft")))) (ExpStatement (AssignExp (VarExp "cont") (boolean false)))) (IfStatement (< (VarExp "key_aux") (VarExp "v_key")) (IfStatement (CallExp (VarExp "current_node") "GetHas_Right") (BlockStatement (ExpStatement (AssignExp (VarExp "parent_node") (VarExp "current_node"))) (ExpStatement (AssignExp (VarExp "current_node") (CallExp (VarExp "current_node") "GetRight")))) (ExpStatement (AssignExp (VarExp "cont") (boolean false)))) (BlockStatement (IfStatement (VarExp "is_root") (IfStatement (&& (NotExp (CallExp (VarExp "current_node") "GetHas_Right")) (NotExp (CallExp (VarExp "current_node") "GetHas_Left"))) (ExpStatement (AssignExp (VarExp "ntb") (boolean true))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (ThisExp) "Remove" (VarExp "parent_node") (VarExp "current_node"))))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (ThisExp) "Remove" (VarExp "parent_node") (VarExp "current_node"))))) (ExpStatement (AssignExp (VarExp "found") (boolean true))) (ExpStatement (AssignExp (VarExp "cont") (boolean false)))))) (ExpStatement (AssignExp (VarExp "is_root") (boolean false)))))) (Return (VarExp "found"))) (MethodDecl (TypeBoolean) "Remove" (Parameters (Parameter (Type "Tree") "p_node") (Parameter (Type "Tree") "c_node")) (VarDecls (VarDecl (TypeBoolean) "ntb") (VarDecl (TypeInt) "auxkey1") (VarDecl (TypeInt) "auxkey2")) (Statements (IfStatement (CallExp (VarExp "c_node") "GetHas_Left") (ExpStatement (AssignExp (VarExp "ntb") (CallExp (ThisExp) "RemoveLeft" (VarExp "p_node") (VarExp "c_node")))) (IfStatement (CallExp (VarExp "c_node") "GetHas_Right") (ExpStatement (AssignExp (VarExp "ntb") (CallExp (ThisExp) "RemoveRight" (VarExp "p_node") (VarExp "c_node")))) (BlockStatement (ExpStatement (AssignExp (VarExp "auxkey1") (CallExp (VarExp "c_node") "GetKey"))) (ExpStatement (AssignExp (VarExp "auxkey2") (CallExp (CallExp (VarExp "p_node") "GetLeft") "GetKey"))) (IfStatement (CallExp (ThisExp) "Compare" (VarExp "auxkey1") (VarExp "auxkey2")) (BlockStatement (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "p_node") "SetLeft" (VarExp "my_null")))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "p_node") "SetHas_Left" (boolean false))))) (BlockStatement (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "p_node") "SetRight" (VarExp "my_null")))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "p_node") "SetHas_Right" (boolean false)))))))))) (Return (boolean true))) (MethodDecl (TypeBoolean) "RemoveRight" (Parameters (Parameter (Type "Tree") "p_node") (Parameter (Type "Tree") "c_node")) (VarDecls (VarDecl (TypeBoolean) "ntb")) (Statements (WhileStatement (CallExp (VarExp "c_node") "GetHas_Right") (BlockStatement (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "c_node") "SetKey" (CallExp (CallExp (VarExp "c_node") "GetRight") "GetKey")))) (ExpStatement (AssignExp (VarExp "p_node") (VarExp "c_node"))) (ExpStatement (AssignExp (VarExp "c_node") (CallExp (VarExp "c_node") "GetRight"))))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "p_node") "SetRight" (VarExp "my_null")))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "p_node") "SetHas_Right" (boolean false))))) (Return (boolean true))) (MethodDecl (TypeBoolean) "RemoveLeft" (Parameters (Parameter (Type "Tree") "p_node") (Parameter (Type "Tree") "c_node")) (VarDecls (VarDecl (TypeBoolean) "ntb")) (Statements (WhileStatement (CallExp (VarExp "c_node") "GetHas_Left") (BlockStatement (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "c_node") "SetKey" (CallExp (CallExp (VarExp "c_node") "GetLeft") "GetKey")))) (ExpStatement (AssignExp (VarExp "p_node") (VarExp "c_node"))) (ExpStatement (AssignExp (VarExp "c_node") (CallExp (VarExp "c_node") "GetLeft"))))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "p_node") "SetLeft" (VarExp "my_null")))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (VarExp "p_node") "SetHas_Left" (boolean false))))) (Return (boolean true))) (MethodDecl (TypeInt) "Search" (Parameters (Parameter (TypeInt) "v_key")) (VarDecls (VarDecl (Type "Tree") "current_node") (VarDecl (TypeInt) "ifound") (VarDecl (TypeBoolean) "cont") (VarDecl (TypeInt) "key_aux")) (Statements (ExpStatement (AssignExp (VarExp "current_node") (ThisExp))) (ExpStatement (AssignExp (VarExp "cont") (boolean true))) (ExpStatement (AssignExp (VarExp "ifound") (int 0))) (WhileStatement (VarExp "cont") (BlockStatement (ExpStatement (AssignExp (VarExp "key_aux") (CallExp (VarExp "current_node") "GetKey"))) (IfStatement (< (VarExp "v_key") (VarExp "key_aux")) (IfStatement (CallExp (VarExp "current_node") "GetHas_Left") (ExpStatement (AssignExp (VarExp "current_node") (CallExp (VarExp "current_node") "GetLeft"))) (ExpStatement (AssignExp (VarExp "cont") (boolean false)))) (IfStatement (< (VarExp "key_aux") (VarExp "v_key")) (IfStatement (CallExp (VarExp "current_node") "GetHas_Right") (ExpStatement (AssignExp (VarExp "current_node") (CallExp (VarExp "current_node") "GetRight"))) (ExpStatement (AssignExp (VarExp "cont") (boolean false)))) (BlockStatement (ExpStatement (AssignExp (VarExp "ifound") (int 1))) (ExpStatement (AssignExp (VarExp "cont") (boolean false))))))))) (Return (VarExp "ifound"))) (MethodDecl (TypeBoolean) "Print" (Parameters) (VarDecls (VarDecl (TypeBoolean) "ntb") (VarDecl (Type "Tree") "current_node")) (Statements (ExpStatement (AssignExp (VarExp "current_node") (ThisExp))) (ExpStatement (AssignExp (VarExp "ntb") (CallExp (ThisExp) "RecPrint" (VarExp "current_node"))))) (Return (boolean true))) (MethodDecl (TypeBoolean) "RecPrint" (Parameters (Parameter (Type "Tree") "node")) (VarDecls (VarDecl (TypeBoolean) "ntb")) (Statements (IfStatement (CallExp (VarExp "node") "GetHas_Left") (BlockStatement (ExpStatement (AssignExp (VarExp "ntb") (CallExp (ThisExp) "RecPrint" (CallExp (VarExp "node") "GetLeft"))))) (ExpStatement (AssignExp (VarExp "ntb") (boolean true)))) (PrintStatement (CallExp (VarExp "node") "GetKey")) (IfStatement (CallExp (VarExp "node") "GetHas_Right") (BlockStatement (ExpStatement (AssignExp (VarExp "ntb") (CallExp (ThisExp) "RecPrint" (CallExp (VarExp "node") "GetRight"))))) (ExpStatement (AssignExp (VarExp "ntb") (boolean true))))) (Return (boolean true))) (MethodDecl (TypeInt) "accept" (Parameters (Parameter (Type "Visitor") "v")) (VarDecls (VarDecl (TypeInt) "nti")) (Statements (PrintStatement (int 333)) (ExpStatement (AssignExp (VarExp "nti") (CallExp (VarExp "v") "visit" (ThisExp))))) (Return (int 0)))) (ClassDecl "Visitor" null (VarDecl (Type "Tree") "l") (VarDecl (Type "Tree") "r") (MethodDecl (TypeInt) "visit" (Parameters (Parameter (Type "Tree") "n")) (VarDecls (VarDecl (TypeInt) "nti")) (Statements (IfStatement (CallExp (VarExp "n") "GetHas_Right") (BlockStatement (ExpStatement (AssignExp (VarExp "r") (CallExp (VarExp "n") "GetRight"))) (ExpStatement (AssignExp (VarExp "nti") (CallExp (VarExp "r") "accept" (ThisExp))))) (ExpStatement (AssignExp (VarExp "nti") (int 0)))) (IfStatement (CallExp (VarExp "n") "GetHas_Left") (BlockStatement (ExpStatement (AssignExp (VarExp "l") (CallExp (VarExp "n") "GetLeft"))) (ExpStatement (AssignExp (VarExp "nti") (CallExp (VarExp "l") "accept" (ThisExp))))) (ExpStatement (AssignExp (VarExp "nti") (int 0))))) (Return (int 0)))) (ClassDecl "MyVisitor" "Visitor" (MethodDecl (TypeInt) "visit" (Parameters (Parameter (Type "Tree") "n")) (VarDecls (VarDecl (TypeInt) "nti")) (Statements (IfStatement (CallExp (VarExp "n") "GetHas_Right") (BlockStatement (ExpStatement (AssignExp (VarExp "r") (CallExp (VarExp "n") "GetRight"))) (ExpStatement (AssignExp (VarExp "nti") (CallExp (VarExp "r") "accept" (ThisExp))))) (ExpStatement (AssignExp (VarExp "nti") (int 0)))) (PrintStatement (CallExp (VarExp "n") "GetKey")) (IfStatement (CallExp (VarExp "n") "GetHas_Left") (BlockStatement (ExpStatement (AssignExp (VarExp "l") (CallExp (VarExp "n") "GetLeft"))) (ExpStatement (AssignExp (VarExp "nti") (CallExp (VarExp "l") "accept" (ThisExp))))) (ExpStatement (AssignExp (VarExp "nti") (int 0))))) (Return (int 0)))))
